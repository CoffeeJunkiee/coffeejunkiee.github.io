---
title:  "Hack The Box / Tally"
date: 2020-01-25
tags: [Penetration Testing, Hacking, Hack The Box, Jeeves, OSCP, Offensive Security]
header: 
  image: "assets/images/tally/tally-header.png"
---

Tally is our third machine in the OSCP list provided by [NetSec Focus](https://www.netsecfocus.com/)! This machine was a great learning experience where the solution problem and research skills were essential in order to root this machine. This is the third blog before my third attempt to the OSCP exam, so let's get to it!

<img src="{{ site.url }}{{ site.baseurl }}/assets/images/tally/list.jpg" alt="oscp list">

## Information Gathering

### Nmap Scan
So, we start with a nmap scan to check what ports are open and what services are running in this machine. 

```
nmap -sC -sV -p- -oN scan.nmap 10.10.10.59
```
<img src="{{ site.url }}{{ site.baseurl }}/assets/images/tally/nmap1.png" alt="nmap scan">
<img src="{{ site.url }}{{ site.baseurl }}/assets/images/tally/nmap2.png" alt="nmap scan">

So, we see some SMB, MSSQL and HTTP services running where all of them are going to be useful. The enumeration in this box is quite extense, but with some persistence and patiente, the clues are going to be coming out one at the time. I also tried to scan most of the HTTP services with not good result, but there was one that actually was useful that I'll explain later. 
After looking at the smb service running, I tried to do some scanning to see if I could find anything, but unf ortunately the result was not helpful.

<img src="{{ site.url }}{{ site.baseurl }}/assets/images/tally/nmap-smb.png" alt="nmap scan">

But after looking for more resources and things to look up in our nmap scan, there was a good __attack vector__ that was related with [Microsoft Sharepoint](https://support.office.com/en-us/article/what-is-sharepoint-97b915e6-651b-43b2-827d-fb25777f446f) running in port 32844. 

<img src="{{ site.url }}{{ site.baseurl }}/assets/images/tally/attack-vector.png" alt="nmap scan">

After looking how other people did this machine, there were a lot of ideas and tools. One of the tools was the [SharePountURLBrute](https://resources.bishopfox.com/resources/tools/sharepoint-hacking-diggity/attack-tools/) that was accurate in some results. This is the command in order to use the tool:
```
perl SharePointURLBrute.pl -a http://10.10.10.59 -e SharePoint-UrlExtensions-18Mar2012.txt
```
<img src="{{ site.url }}{{ site.baseurl }}/assets/images/tally/sharepoint-urlbrute.png" alt="nmap scan">


